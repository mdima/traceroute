@page "/"
@using static TraceRoute.Models.TraceResultViewModel

<div class="row m-0 p-0 fullHeight">
    <div class="col-12 col-md-7 m-0 p-0 mobile-50">
        <div id="map" class="tr-map"></div>
    </div>
    <div class="col-12 col-md-5 m-0 p-0 pb-5 mobile-max-50 table-responsive">
        <h5 class="bg-secondary text-white ps-3 p-2">Route details</h5>
        <table class="table table-striped table-sm m-0">
            <thead class="thead-dark">
                <tr>
                    <th scope="col" class="ps-2">#</th>
                    <th scope="col">IP</th>
                    <th scope="col">Trip time</th>
                    <th scope="col" class="d-none d-lg-table-cell">Location</th>
                    <th scope="col" class="d-none d-lg-table-cell">ISP</th>
                </tr>
            </thead>
            <tbody>
                @if (Hops != null)
                {
                    foreach (TraceHop hop in Hops)
                    {
                        <tr class="tr_hop_@(hop.Index)" data-index-value="@(hop.Index)" onmouseover="hilightTooltip(this)">
                            <td class="ps-2 tr_hop_@(hop.Index)">@hop.Index</td>
                            <td class="tr_hop_@(hop.Index)">
                                @if (!hop.Details.IsBogonIP && hop.HopAddress != "...")
                                {
                                    <a href="#" class="link-secondary" @onclick="() => IpDetails(hop)">@hop.HopAddress</a>
                                }
                                else
                                {
                                    @hop.HopAddress
                                }
                                @if (hop.Details.HostName != null)
                                {
                                    <small class="small text-muted">
                                        <br />@hop.Details.HostName
                                    </small>
                                }
                            </td>
                            <td class="small text-end text-nowrap tr_hop_@(hop.Index)">
                                @if (hop.TripTime != 0) {
                                    @String.Format("{0:0.000} ms", hop.TripTime)
                                }
                            </td>
                            @if (String.IsNullOrEmpty(hop.Details.ISP) && !hop.Details.IsBogonIP) {
                                <td colspan="2" class="small tr_hop_@hop.Index">
                                    <div class="spinner-border spinner-border-sm" role="status">
                                        <span class="visually-hidden">Loading...</span>
                                    </div>
                                </td>
                            } 
                            else 
                            {
                                <td class="small text-break tr_hop_@hop.Index d-none d-lg-table-cell">
                                    @if (hop.Details.Country != null)
                                    {
                                        @String.Format("{0} - {1}", hop.Details.Country, @hop.Details.City)
                                    }
                                </td>
                                <td class="small text-break tr_hop_@hop.Index d-none d-lg-table-cell">
                                    @if (hop.Details.ISP != null)
                                    {
                                        @hop.Details.ISP
                                    }
                                </td>
                            }
                        </tr>
                    }
                }
            </tbody>
        </table>
    </div>
</div>